(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{67:function(){},2061:function(){},2194:function(e,t,a){Promise.resolve().then(a.bind(a,5447))},5447:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var s=a(7437),n=a(2265),r=a(7907),c=a(8121),i=a(8818),o=a(3268),l=a(6285),d=a(4323);function u(){let[e,t]=(0,n.useState)({}),a=(0,r.useRouter)();(0,n.useEffect)(()=>{(async()=>{try{let e=(await (0,c.PL)((0,c.hJ)(i.db,"applications"))).docs.map(e=>e.data()).reduce((e,t)=>(e[t.status.toLowerCase()]+=1,e),{Applied:0,Rejected:0,Accepted:0,Waitlisted:0,Pending:0});t(e)}catch(e){console.error("Error fetching stats:",e)}})()},[]);let u=async()=>{try{let e=(await (0,c.PL)((0,c.hJ)(i.db,"applications"))).docs.map(e=>e.data()),t=d.P6.json_to_sheet(e),a=d.P6.book_new();d.P6.book_append_sheet(a,t,"Applications"),d.NC(a,"applications.xlsx")}catch(e){console.error("Error exporting data:",e)}},p=async e=>{try{let a=await (0,c.PL)((0,c.hJ)(i.db,"applications")),s={};for(let n of(a.docs.forEach(e=>{s[e.data().uid]=e.id}),e)){let{uid:e,status:a}=n,r=s[e];if(r){let e=(0,c.JU)(i.db,"applications",r);await (0,c.r7)(e,{status:a}),t(e=>({...e,[a.toLowerCase()]:(e[a.toLowerCase()]||0)+1}))}else console.warn("No document found for uid: ".concat(e))}alert("Statuses updated successfully!")}catch(e){console.error("Error updating statuses:",e),alert("Failed to update statuses. Please check the console for errors.")}};return(0,s.jsx)(o.Z,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen py-2",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-8",children:"Admin Dashboard"}),(0,s.jsx)("div",{className:"flex justify-around w-full max-w-4xl mb-8",children:Object.entries(e).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:t}),(0,s.jsx)("p",{className:"text-lg",children:a})]},t)})}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)(l.Z,{variant:"contained",color:"primary",onClick:()=>a.push("/admin/stats"),children:"View Stats"}),(0,s.jsx)(l.Z,{variant:"contained",color:"primary",onClick:()=>a.push("/admin/applicants"),children:"View Applicants"}),(0,s.jsx)(l.Z,{variant:"contained",color:"secondary",onClick:u,children:"Export Data"})]}),(0,s.jsx)("input",{type:"file",accept:".xlsx, .xls",onChange:e=>{let t=e.target.files[0];if(t){let e=new FileReader;e.onload=async e=>{let t=new Uint8Array(e.target.result),a=d.ij(t,{type:"array"}),s=a.SheetNames[0],n=a.Sheets[s],r=d.P6.sheet_to_json(n);await p(r)},e.readAsArrayBuffer(t)}},className:"mt-8"})]})})}},3268:function(e,t,a){"use strict";var s=a(7437),n=a(2265),r=a(7907),c=a(2730),i=a(8818),o=a(8121);t.Z=e=>{let{children:t}=e,[a,l]=(0,n.useState)(!0),d=(0,r.useRouter)();(0,n.useEffect)(()=>{let e=(0,c.Aj)(i.I8,async e=>{e&&await u(e.email)?l(!1):d.push("/admin/login")});return()=>e()},[d]);let u=async e=>{let t=(0,o.JU)(i.db,"admin",e);return(await (0,o.QT)(t)).exists()};return a?(0,s.jsx)("div",{children:"Loading..."}):t}},8818:function(e,t,a){"use strict";a.d(t,{I8:function(){return o},Vv:function(){return u},db:function(){return l},tO:function(){return d}});var s=a(6142),n=a(2730),r=a(8121),c=a(4905);let i=(0,s.ZF)({apiKey:"AIzaSyDxN0BfrPW5oEJxOoIYXjn4-0BTru8d1qo",authDomain:"bhacks-2024.firebaseapp.com",projectId:"bhacks-2024",storageBucket:"bhacks-2024.appspot.com",messagingSenderId:"467509416161",appId:"1:467509416161:web:1cb17aa19bc08d384a67a0",measurementId:"G-N1CKCGF5RV"}),o=(0,n.v0)(i),l=(0,r.ad)(i),d=(0,c.cF)(i),u=new n.hJ}},function(e){e.O(0,[358,67,425,157,658,656,254,971,69,744],function(){return e(e.s=2194)}),_N_E=e.O()}]);